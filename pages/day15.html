<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>DAY 15: Excel - Power Query Basics + WEEK 3 TEST</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/opendyslexic" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    
    :root {
      /* Light theme (default - Claude style) */
      --bg-primary: #F5F3EF;
      --bg-secondary: #FFFFFF;
      --bg-sidebar: #FDFCFA;
      --text-primary: #1A1A1A;
      --text-secondary: #6B6B6B;
      --text-tertiary: #9B9B9B;
      --accent-orange: #D97757;
      --accent-brown: #8B6B47;
      --border-subtle: #E5E2DC;
      --border-light: #F0EDE7;
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07);
      --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
    }

    [data-theme="dark"] {
      /* Dark theme (Claude desktop style) */
      --bg-primary: #1F1F1F;
      --bg-secondary: #2B2B2B;
      --bg-sidebar: #242424;
      --text-primary: #ECECEC;
      --text-secondary: #A8A8A8;
      --text-tertiary: #7A7A7A;
      --accent-orange: #E89A7A;
      --accent-brown: #B8936A;
      --border-subtle: #3A3A3A;
      --border-light: #333333;
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);
    }

    /* Font families */
    html {
      font-family: Candara, 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif;
    }

    [data-font="candara"] {
      font-family: Candara, 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif;
    }

    [data-font="arial"] {
      font-family: Arial, Helvetica, sans-serif;
    }

    [data-font="courier"] {
      font-family: 'Courier New', Courier, monospace;
    }

    [data-font="georgia"] {
      font-family: Georgia, 'Times New Roman', serif;
    }

    [data-font="dyslexic"] {
      font-family: 'OpenDyslexic', sans-serif;
    }

    /* Font sizes */
    html {
      font-size: 16px;
    }

    [data-font-size="small"] {
      font-size: 14px;
    }

    [data-font-size="medium"] {
      font-size: 16px;
    }

    [data-font-size="large"] {
      font-size: 18px;
    }

    [data-font-size="x-large"] {
      font-size: 20px;
    }

    html, body {
      height: 100%;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Header */
    #title-block-header {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
      border-bottom: 3px solid var(--accent-orange);
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow-lg);
    }

    .header-row {
      max-width: 1600px;
      margin: 0 auto;
      padding: 1.25rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 2rem;
    }

    .title {
      font-size: 1.5rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent-orange) 0%, var(--accent-brown) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -0.02em;
      margin: 0;
      white-space: nowrap;
    }

    .header-author {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-left: auto;
    }

    .author-name {
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--text-secondary);
      font-style: italic;
    }

    .repo-link {
      display: flex;
      align-items: center;
      color: var(--text-secondary);
      transition: all 0.2s ease;
      padding: 0.25rem;
      border-radius: var(--radius-sm);
    }

    .repo-link:hover {
      color: var(--accent-orange);
      background: var(--bg-primary);
      transform: scale(1.1);
    }

    .repo-link svg {
      display: block;
    }

    .header-controls {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    .font-selector {
      background: var(--bg-primary);
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      padding: 0.5rem 0.75rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 500;
      transition: all 0.2s ease;
      outline: none;
    }

    .font-selector:hover {
      background: var(--bg-secondary);
      border-color: var(--accent-brown);
      color: var(--text-primary);
    }

    .font-selector:focus {
      border-color: var(--accent-orange);
      box-shadow: 0 0 0 3px rgba(217, 119, 87, 0.1);
    }

    .font-size-controls {
      display: flex;
      gap: 0.25rem;
      align-items: center;
    }

    .font-size-btn {
      background: var(--bg-primary);
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      width: 2.25rem;
      height: 2.25rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 0.75rem;
      font-weight: 600;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .font-size-btn:hover {
      background: var(--bg-secondary);
      border-color: var(--accent-brown);
      color: var(--text-primary);
      transform: translateY(-1px);
    }

    .font-size-btn:active {
      transform: translateY(0);
    }

    .font-size-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .font-size-btn:disabled:hover {
      background: var(--bg-primary);
      border-color: var(--border-subtle);
      transform: none;
    }

    .theme-toggle {
      background: var(--bg-primary);
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      padding: 0.5rem 0.875rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 500;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .theme-toggle:hover {
      background: var(--bg-secondary);
      border-color: var(--accent-brown);
      color: var(--text-primary);
    }

    .button {
      background: var(--bg-primary);
      color: var(--text-secondary);
      border: 1px solid var(--border-subtle);
      padding: 0.5rem 0.875rem;
      border-radius: var(--radius-sm);
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .button:hover {
      background: var(--bg-secondary);
      border-color: var(--accent-brown);
      color: var(--text-primary);
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    /* Layout */
    .page {
      max-width: 1600px;
      margin: 0 auto;
      display: flex;
      gap: 2rem;
      padding: 2rem;
      min-height: calc(100vh - 80px);
    }

    /* Modern Sidebar */
    nav#TOC {
      width: 320px;
      min-width: 320px;
      background: var(--bg-sidebar);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      align-self: flex-start;
      position: sticky;
      top: 100px;
      max-height: calc(100vh - 120px);
      overflow-y: auto;
      box-shadow: var(--shadow-sm);
      scroll-behavior: smooth;
    }

    nav#TOC::-webkit-scrollbar {
      width: 6px;
    }

    nav#TOC::-webkit-scrollbar-track {
      background: transparent;
    }

    nav#TOC::-webkit-scrollbar-thumb {
      background: var(--border-subtle);
      border-radius: 3px;
    }

    nav#TOC::-webkit-scrollbar-thumb:hover {
      background: var(--accent-brown);
    }

    nav#TOC ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    nav#TOC > ul > li {
      margin-bottom: 1.5rem;
    }

    nav#TOC li {
      margin: 0;
    }

    nav#TOC a {
      display: block;
      color: var(--text-secondary);
      text-decoration: none;
      padding: 0.5rem 0.75rem;
      border-radius: var(--radius-sm);
      font-size: 0.8125rem;
      font-weight: 500;
      transition: all 0.2s ease;
      line-height: 1.4;
    }

    nav#TOC > ul > li > a {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 0.875rem;
      margin-bottom: 0.5rem;
    }

    nav#TOC a:hover {
      background: var(--bg-secondary);
      color: var(--accent-orange);
      transform: translateX(2px);
    }

    /* Active page highlighting */
    nav#TOC a.active {
      background: var(--accent-orange);
      color: white;
      font-weight: 600;
    }

    nav#TOC a.active:hover {
      background: var(--accent-brown);
      color: white;
    }

    nav#TOC ul ul {
      margin-top: 0.25rem;
      margin-left: 0.75rem;
      padding-left: 0.75rem;
      border-left: 2px solid var(--border-light);
    }

    /* Content Area */
    .content {
      flex: 1;
      min-width: 0;
      background: var(--bg-secondary);
      border-radius: var(--radius-lg);
      padding: 3rem;
      box-shadow: var(--shadow-sm);
    }

    /* Typography */
    h1 {
      font-size: 2.25rem;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.02em;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--border-subtle);
    }

    h2 {
      font-size: 1.875rem;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.015em;
      margin: 2.5rem 0 1.5rem 0;
      padding: 1.25rem 1.5rem;
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      border-left: 4px solid var(--accent-orange);
      border-radius: var(--radius-sm);
      box-shadow: var(--shadow-sm);
    }

    h3 {
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 2rem 0 1rem 0;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border-light);
    }

    p {
      color: var(--text-secondary);
      margin-bottom: 1rem;
      line-height: 1.7;
    }

    strong {
      color: var(--text-primary);
      font-weight: 600;
    }

    a {
      color: var(--accent-orange);
      text-decoration: none;
      transition: color 0.2s ease;
    }

    a:hover {
      color: var(--accent-brown);
      text-decoration: underline;
    }

    /* External Links with Icon */
    .external-link {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.25rem 0.5rem;
      background: var(--bg-primary);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--accent-orange);
      transition: all 0.2s ease;
      word-break: break-all;
    }

    .external-link:hover {
      background: var(--accent-orange);
      color: white;
      border-color: var(--accent-orange);
      text-decoration: none;
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    .link-icon {
      flex-shrink: 0;
      opacity: 0.7;
      transition: opacity 0.2s ease;
    }

    .external-link:hover .link-icon {
      opacity: 1;
    }

    /* Lists */
    ul, ol {
      margin: 1rem 0;
      padding-left: 1.5rem;
      color: var(--text-secondary);
    }

    li {
      margin: 0.5rem 0;
      line-height: 1.6;
    }

    /* Code */
    code {
      background: var(--bg-primary);
      color: var(--accent-brown);
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
      font-size: 0.875em;
      font-weight: 500;
    }

    pre {
      background: var(--bg-primary);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      overflow-x: auto;
      margin: 1.5rem 0;
      position: relative;
    }

    pre code {
      background: none;
      padding: 0;
      color: var(--text-primary);
      font-size: 0.9rem;
      line-height: 1.6;
    }

    /* Copy button for code blocks */
    .copy-btn {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      color: var(--text-secondary);
      padding: 0.5rem;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      opacity: 0;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
    }

    pre:hover .copy-btn {
      opacity: 1;
    }

    .copy-btn:hover {
      background: var(--accent-orange);
      color: white;
      border-color: var(--accent-orange);
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .copy-btn.copied {
      background: var(--accent-brown);
      color: white;
    }

    .copy-btn svg {
      flex-shrink: 0;
    }

    /* AI Assistant Buttons - Dynamically Added */
    .ai-assistant-buttons {
      position: absolute;
      bottom: 0.75rem;
      right: 0.75rem;
      display: flex;
      gap: 0.5rem;
      align-items: center;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    pre:hover .ai-assistant-buttons {
      opacity: 1;
    }

    .ai-quick-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      padding: 0.5rem 0.75rem;
      border-radius: 6px;
      font-size: 0.8125rem;
      font-weight: 500;
      text-decoration: none;
      transition: all 0.2s ease;
      border: 1px solid;
      min-width: 36px;
      min-height: 36px;
    }

    /* All AI buttons - Consistent black and white theme */
    .chatgpt-btn,
    .claude-btn,
    .google-btn {
      background: #000000;
      color: white;
      border-color: #333333;
    }

    .chatgpt-btn:hover,
    .claude-btn:hover,
    .google-btn:hover {
      background: #333333;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
      text-decoration: none;
    }

    /* Make sure icons are white */
    .ai-quick-btn svg,
    .ai-quick-btn img {
      filter: brightness(0) invert(1);
    }

    .ai-quick-btn svg {
      flex-shrink: 0;
    }

    /* Quiz Styles */
    .quiz-container {
      margin: 2rem 0;
      padding: 1.5rem;
      background: var(--bg-primary);
      border: 2px solid var(--accent-orange);
      border-radius: var(--radius-md);
    }

    .quiz-question {
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: var(--bg-secondary);
      border-radius: var(--radius-sm);
      border-left: 4px solid var(--text-tertiary);
      transition: border-color 0.3s ease;
    }

    .quiz-question.correct {
      border-left-color: #10b981;
      background: rgba(16, 185, 129, 0.1);
    }

    .quiz-question.incorrect {
      border-left-color: #ef4444;
      background: rgba(239, 68, 68, 0.1);
    }

    .question-text {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 1rem;
    }

    .quiz-options {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .quiz-option {
      display: flex;
      align-items: center;
      padding: 0.875rem 1.25rem;
      background: var(--bg-primary);
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .quiz-option:hover {
      border-color: var(--accent-orange);
      transform: translateX(4px);
    }

    .quiz-option input[type="radio"] {
      margin-right: 0.75rem;
      cursor: pointer;
    }

    .option-text {
      color: var(--text-secondary);
      font-size: 0.9375rem;
    }

    .quiz-feedback {
      margin-top: 1rem;
      padding: 1rem 1.25rem;
      border-radius: var(--radius-sm);
    }

    .quiz-feedback.correct {
      background: rgba(16, 185, 129, 0.15);
      border: 1px solid #10b981;
    }

    .quiz-feedback.incorrect {
      background: rgba(239, 68, 68, 0.15);
      border: 1px solid #ef4444;
    }

    .feedback-text {
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .feedback-text.correct {
      color: #10b981;
    }

    .feedback-text.incorrect {
      color: #ef4444;
    }

    .explanation {
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-style: italic;
      margin: 0;
    }


    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      overflow: hidden;
    }

    th, td {
      padding: 0.875rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-light);
    }

    th {
      background: var(--bg-primary);
      color: var(--text-primary);
      font-weight: 600;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    td {
      color: var(--text-secondary);
    }

    tr:last-child td {
      border-bottom: none;
    }

    /* Horizontal Rule */
    hr {
      border: none;
      height: 1px;
      background: var(--border-subtle);
      margin: 2.5rem 0;
    }

    /* Feedback Bar */
    .feedback-bar {
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-subtle);
      padding: 1.5rem 2rem;
      text-align: center;
      margin-top: 3rem;
    }

    .feedback-bar p {
      margin: 0;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .feedback-link {
      color: var(--accent-orange);
      font-weight: 500;
      text-decoration: none;
      transition: color 0.2s ease;
    }

    .feedback-link:hover {
      color: var(--accent-brown);
      text-decoration: underline;
    }

    /* Practice Notes */
    .practice-note {
      background: var(--bg-primary);
      border: 1px solid var(--border-subtle);
      border-left: 4px solid var(--accent-brown);
      border-radius: var(--radius-sm);
      padding: 1.25rem 1.5rem;
      margin: 1rem 0 1.5rem 0;
    }

    .practice-note p {
      margin-bottom: 0.75rem;
      color: var(--text-primary);
    }

    .practice-note ul {
      margin: 0;
      padding-left: 1.5rem;
    }

    .practice-note li {
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
      line-height: 1.6;
    }

    .practice-note strong {
      color: var(--text-primary);
    }

    /* Back to top - Fixed button */
    .back-to-top {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 3rem;
      height: 3rem;
      background: var(--accent-orange);
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: visible;
    }

    .back-to-top::before {
      content: '‚Üë';
      display: block;
    }

    .back-to-top::after {
      content: 'Back to Top';
      position: absolute;
      right: 100%;
      margin-right: 0.75rem;
      background: var(--bg-secondary);
      color: var(--text-primary);
      padding: 0.5rem 1rem;
      border-radius: var(--radius-sm);
      font-size: 0.875rem;
      font-weight: 500;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      box-shadow: var(--shadow-md);
      border: 1px solid var(--border-subtle);
    }

    .back-to-top:hover {
      background: var(--accent-brown);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }

    .back-to-top:hover::after {
      opacity: 1;
    }

    /* Section Cards */
    .section-card {
      background: var(--bg-primary);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      margin: 1.5rem 0;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .page {
        flex-direction: column;
        padding: 1rem;
      }

      nav#TOC {
        position: static;
        width: 100%;
        max-height: none;
        margin-bottom: 2rem;
      }

      .content {
        padding: 2rem 1.5rem;
      }
    }

    @media (max-width: 640px) {
      .header-row {
        padding: 1rem;
      }

      .title {
        font-size: 1rem;
      }

      .content {
        padding: 1.5rem 1rem;
      }

      h1 {
        font-size: 1.75rem;
      }

      h2 {
        font-size: 1.5rem;
      }
    }
  </style>
</head>

<body>
<header id="title-block-header">
  <div class="header-row">
    <h1 class="title">DAY 15: Excel - Power Query Basics + WEEK 3 TEST</h1>
    <div class="header-author">
      <span class="author-name">Guru Charan Pathalla</span>
      <a href="https://github.com/gcpathalla/sql_and_excel" target="_blank" class="repo-link" title="View on GitHub">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
        </svg>
      </a>
    </div>
    <div class="header-controls">
      <select class="font-selector" id="font-selector" aria-label="Select font">
        <option value="candara">Candara</option>
        <option value="arial">Arial</option>
        <option value="courier">Courier New</option>
        <option value="georgia">Georgia</option>
        <option value="dyslexic">OpenDyslexic</option>
      </select>
      <div class="font-size-controls">
        <button class="font-size-btn" id="decrease-font" aria-label="Decrease font size" title="Decrease font size">A-</button>
        <button class="font-size-btn" id="increase-font" aria-label="Increase font size" title="Increase font size">A+</button>
      </div>
      <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
        <span class="theme-icon">üåô</span>
        <span class="theme-text">Dark</span>
      </button>
    </div>
  </div>
</header>
<div class="page">
  <nav id="TOC" role="navigation">
<ul>
<li><a href="../SQL-and-Excel-Course.html">üìö Training Overview</a></li>
<li><a href="week1.html">Week 1: Foundations</a>
<ul>
<li><a href="day1.html">Day 1: Excel - Formulas
& Basic Functions</a></li>
<li><a href="day2.html">Day 2: SQL - SELECT &
Aggregates</a></li>
<li><a href="day3.html">Day 3: Excel -
Filtering & Conditional Funct...</a></li>
<li><a href="day4.html">Day 4: SQL - WHERE Clause
& Filtering</a></li>
<li><a href="day5.html">Day 5: Excel - VLOOKUP &
XLOOKUP</a></li>
</ul>
</li>
<li><a href="week2.html">Week 2: Data Analysis</a>
<ul>
<li><a href="day6.html">Day 6: SQL - JOIN Operations</a></li>
<li><a href="day7.html">Day 7: Excel - Pivot Tables
& Charts</a></li>
<li><a href="day8.html">Day 8: SQL - GROUP BY &
HAVING</a></li>
<li><a href="day9.html">Day 9: Excel - Advanced Functions (SUMIFS, C...</a></li>
<li><a href="day10.html">Day 10: SQL - Subqueries</a></li>
</ul>
</li>
<li><a href="week3.html">Week 3: Intermediate Concepts</a>
<ul>
<li><a href="day11.html">Day 11: Excel - Date Functions (TODAY, DATEDI...</a></li>
<li><a href="day12.html">Day 12: SQL - Date Functions & Window Functio...</a></li>
<li><a href="day13.html">Day 13: Excel - What-If Analysis (Goal Seek, ...</a></li>
<li><a href="day14.html">Day 14: SQL - Window Functions Part 2 (LAG, L...</a></li>
<li><a href="day15.html">Day 15: Excel - Power Query Basics + WEEK 3 TEST</a></li>
</ul>
</li>
<li><a href="week4.html">Week 4: Advanced Concepts</a>
<ul>
<li><a href="day16.html">Day 16: SQL - CTEs & Recursive Queries</a></li>
<li><a href="day17.html">Day 17: Excel - Power Pivot & Data Modeling (...</a></li>
<li><a href="day18.html">Day 18: SQL - CASE Statements & PIVOT/UNPIVOT</a></li>
<li><a href="day19.html">Day 19: Excel - Advanced Charts & Dashboards</a></li>
<li><a href="day20.html">Day 20: SQL - Views, Stored Procedures, Optim...</a></li>
</ul>
</li>
<li><a href="week5.html">Week 5: Analytics & Optimization</a>
<ul>
<li><a href="day21.html">Day 21: Excel - Statistical Analysis & Foreca...</a></li>
<li><a href="day22.html">Day 22: SQL - Advanced Aggregations (GROUPING...</a></li>
<li><a href="day23.html">Day 23: Excel - Advanced Conditional Formatti...</a></li>
<li><a href="day24.html">Day 24: SQL - Query Optimization & Performanc...</a></li>
<li><a href="day25.html">Day 25: Integration Project: Excel + SQL + WE...</a></li>
</ul>
</li>
<li><a href="week6.html">Week 6: Mastery & Projects</a>
<ul>
<li><a href="day26.html">Day 26: Excel - Macros & Automation Basics</a></li>
<li><a href="day27.html">Day 27: SQL - Advanced Analytics (Cohort, Ret...</a></li>
<li><a href="day28.html">Day 28: Excel - Executive Dashboard Creation</a></li>
<li><a href="day29.html">Day 29: SQL - Complex Business Scenarios</a></li>
<li><a href="day30.html">Day 30: FINAL PROJECT & COMPREHENSIVE ASSESSMENT</a></li>
</ul>
</li>
</ul>
  </nav>
  <div class="content">
<h2 id="day-15-day-15-excel---power-query-basics-+-week-3-test">DAY 15: Excel - Power Query Basics + WEEK 3 TEST</h2>
<p><strong>Learning Objectives:</strong>
- Introduction to Power Query Editor
- Import and transform data from multiple sources
- Clean and reshape data
- Combine queries (merge and append)
- Review Week 3 concepts</p>
<h3 id="topics-covered-hour-1---60-min-15">Topics Covered (60 min):</h3>
<p><strong>1. Power Query Introduction</strong>
- Data ‚Üí Get Data ‚Üí From File/Database/Web
- Power Query Editor interface
- Applied Steps pane (transformation history)
- Load data to worksheet or data model</p>
<p><strong>2. Data Cleaning Operations</strong>
- Remove duplicates
- Fill down/up missing values
- Replace values
- Change data types
- Trim and clean text
- Split columns by delimiter</p>
<p><strong>3. Data Transformation</strong>
- Filter rows
- Remove columns
- Pivot/Unpivot columns
- Group by aggregations
- Add custom columns with formulas</p>
<p><strong>4. Combining Queries</strong>
- Merge queries (like JOIN in SQL)
- Append queries (union/stack tables)
- Reference vs duplicate queries
- Merge types: Left, Right, Inner, Full Outer</p>
<h3 id="video-resources-15">Video Resources:</h3>
<ol type="1">
<li><p><strong>Excel Data Visualization Course ‚Äì Guide to Charts &amp; Dashboards</strong> (0:10)<br/>
<a class="external-link" href="https://www.youtube.com/watch?v=VV8iRJ-DS0A" target="_blank" title="Open link"><svg class="link-icon" fill="currentColor" height="14" viewbox="0 0 16 16" width="14"><path d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"></path><path d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"></path></svg> https://www.youtube.com/watch?v=VV8iRJ-DS0A</a></p></li>
<li><p><strong>Interactive Excel Charts and Dashboards</strong> (39:00)<br/>
<a class="external-link" href="https://www.youtube.com/watch?v=aDSR4L1f6TY" target="_blank" title="Open link"><svg class="link-icon" fill="currentColor" height="14" viewbox="0 0 16 16" width="14"><path d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"></path><path d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"></path></svg> https://www.youtube.com/watch?v=aDSR4L1f6TY</a></p></li>
<li><p><strong>How to Build Excel Interactive Dashboards</strong> (16:00)<br/>
<a class="external-link" href="https://www.youtube.com/watch?v=bYA9kFE-cRA" target="_blank" title="Open link"><svg class="link-icon" fill="currentColor" height="14" viewbox="0 0 16 16" width="14"><path d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"></path><path d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"></path></svg> https://www.youtube.com/watch?v=bYA9kFE-cRA</a></p></li>
</ol>
<h3 id="ai-learning-prompts-concept-understanding-only-15">AI Learning Prompts (Concept Understanding Only):</h3>
<p><strong>Understanding Power Query:</strong></p>
<pre><code>I'm learning Power Query in Excel. Please explain:

1. What is Power Query and when should I use it vs regular Excel formulas?
2. How do I import data from CSV files and clean it?
3. What are Applied Steps and how do they work?
4. Show me how to remove duplicates and fill missing values
5. Provide a beginner-friendly workflow for cleaning messy data

Use step-by-step examples.</code></pre>
<p><strong>Understanding Merge and Append:</strong></p>
<pre><code>Help me understand combining queries in Power Query:

1. What is the difference between Merge and Append?
2. How is Merge similar to SQL JOIN?
3. Explain Left, Right, Inner, and Full Outer merge
4. When should I use Append vs Merge?
5. Show me examples using customer and order tables

Explain with practical scenarios.</code></pre>
<h3 id="guided-practice-hour-2---60-min-15">Guided Practice (60 min):</h3>
<div class="practice-note">
<p><strong>üìù How to approach Guided Practice:</strong></p>
<ul>
<li><strong>Follow step-by-step:</strong> Work through each exercise in order</li>
<li><strong>Use provided resources:</strong> Reference the video tutorials and AI prompts if you get stuck</li>
<li><strong>Verify your work:</strong> Check your results match expected outcomes</li>
<li><strong>Take notes:</strong> Document key learnings and shortcuts you discover</li>
<li><strong>Ask for help:</strong> Use AI assistants to clarify concepts you don't understand</li>
</ul>
</div>
<div class="section-card">
<p><strong>Exercise 1: Import and Clean CSV Data with Power Query</strong></p>
<p><strong>Goal:</strong> Learn to import messy CSV data into Excel using Power Query and apply automated data cleaning transformations.</p>

<p><strong>Setup:</strong> Download or create a sample CSV file with customer data that includes duplicates, extra spaces, inconsistent capitalization, and missing values.</p>

<p><strong>Step-by-Step Instructions:</strong></p>
<ol>
<li><strong>Open Excel</strong> and create a new blank workbook</li>
<li><strong>Access Power Query:</strong> Navigate to the <strong>Data</strong> tab on the ribbon</li>
<li><strong>Import CSV file:</strong> Click <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí <strong>From Text/CSV</strong></li>
<li><strong>Select your CSV file</strong> and click <strong>Import</strong>. Excel will show a preview of the data</li>
<li><strong>Click "Transform Data"</strong> instead of "Load" - this opens the Power Query Editor (keyboard shortcut: <code>Alt ‚Üí A ‚Üí F ‚Üí T</code> in sequence)</li>
<li><strong>Observe the Power Query Editor interface:</strong> Notice the ribbon with transformation options, the query pane on the left, and the "Applied Steps" pane on the right showing each transformation</li>
<li><strong>Remove duplicates:</strong> Select the CustomerID column, then click <strong>Home</strong> ‚Üí <strong>Remove Rows</strong> ‚Üí <strong>Remove Duplicates</strong></li>
<li><strong>Trim extra spaces:</strong> Select the Name column, right-click column header ‚Üí <strong>Transform</strong> ‚Üí <strong>Trim</strong> (removes leading/trailing spaces)</li>
<li><strong>Fix capitalization:</strong> While Name column is still selected, right-click ‚Üí <strong>Transform</strong> ‚Üí <strong>Capitalize Each Word</strong></li>
<li><strong>Replace null values:</strong> Select the Phone column, click <strong>Transform</strong> tab ‚Üí <strong>Replace Values</strong>, enter <code>null</code> in "Value To Find" and <code>Not Provided</code> in "Replace With"</li>
<li><strong>Change data types:</strong> Select the CustomerID column, click the data type icon (ABC/123) in the column header ‚Üí choose <strong>Whole Number</strong></li>
<li><strong>Rename columns for clarity:</strong> Double-click the "CustomerID" column header and rename to "Customer ID" (with space)</li>
<li><strong>Review Applied Steps:</strong> Look at the right pane to see each transformation listed - you can click any step to see the data at that point</li>
<li><strong>Close and Load:</strong> Click <strong>Home</strong> ‚Üí <strong>Close & Load</strong> (or <code>Alt ‚Üí H ‚Üí C ‚Üí L</code>) to load the cleaned data into Excel</li>
<li><strong>Verify the results:</strong> Check that your data is now clean with no duplicates, proper capitalization, and handled null values</li>
</ol>

<p><strong>üí° Tips:</strong></p>
<ul>
<li><strong>Non-destructive editing:</strong> Power Query doesn't change your source file - all transformations are stored as steps you can modify later</li>
<li><strong>Refreshable transformations:</strong> If your source CSV updates, just right-click the table ‚Üí <strong>Refresh</strong> to reapply all cleaning steps automatically</li>
<li><strong>Applied Steps are editable:</strong> Click the gear icon next to any step in "Applied Steps" to modify or delete it</li>
<li><strong>Keyboard shortcut:</strong> Press <code>Ctrl+Z</code> in Power Query Editor to undo the last transformation</li>
<li><strong>Column operations shortcuts:</strong> Right-click any column header for quick access to common transformations</li>
<li><strong>Formula bar:</strong> Advanced users can see and edit the M code (Power Query language) behind each step using the formula bar</li>
</ul>

<p><strong>‚úÖ Expected Result:</strong> A clean Excel table with no duplicates, trimmed text, proper capitalization, handled null values, and correct data types. The table has a connection to the source CSV that can be refreshed anytime.</p>

<p><strong>üîÑ Connection to Day 13:</strong> Just like Day 13's What-If Analysis automated scenario testing, Power Query automates data cleaning. Instead of manually cleaning data repeatedly, you create a reusable transformation workflow that adapts to new data!</p>
</div>

<div class="section-card">
<p><strong>Exercise 2: Transform and Reshape Data with Column Operations</strong></p>
<p><strong>Goal:</strong> Master Power Query's column transformation features including splitting, merging, extracting, and creating custom columns.</p>

<p><strong>Setup:</strong> Use a dataset with a "FullName" column (e.g., "John Smith") and an "OrderDate" column that needs to be split into components.</p>

<p><strong>Step-by-Step Instructions:</strong></p>
<ol>
<li><strong>Open Power Query Editor:</strong> From the Data tab, click <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí <strong>From Excel Workbook</strong> (or use your existing query)</li>
<li><strong>Click "Transform Data"</strong> to open the Power Query Editor</li>
<li><strong>Split column by delimiter:</strong> Select the FullName column ‚Üí <strong>Home</strong> ‚Üí <strong>Split Column</strong> ‚Üí <strong>By Delimiter</strong></li>
<li><strong>Configure split:</strong> Choose "Space" as delimiter, select "At the leftmost delimiter", click OK</li>
<li><strong>Rename split columns:</strong> Rename "FullName.1" to "First Name" and "FullName.2" to "Last Name"</li>
<li><strong>Extract date components:</strong> Select the OrderDate column (ensure it's Date type) ‚Üí click <strong>Add Column</strong> tab</li>
<li><strong>Extract year:</strong> With OrderDate selected, click <strong>Date</strong> ‚Üí <strong>Year</strong> (creates new column with year values)</li>
<li><strong>Extract month name:</strong> Select OrderDate again ‚Üí <strong>Add Column</strong> ‚Üí <strong>Date</strong> ‚Üí <strong>Month</strong> ‚Üí <strong>Name of Month</strong></li>
<li><strong>Extract day of week:</strong> Select OrderDate again ‚Üí <strong>Add Column</strong> ‚Üí <strong>Date</strong> ‚Üí <strong>Day</strong> ‚Üí <strong>Name of Day</strong></li>
<li><strong>Create custom column with calculation:</strong> Click <strong>Add Column</strong> ‚Üí <strong>Custom Column</strong></li>
<li><strong>Configure custom column:</strong> Name it "Days Since Order", enter formula: <code>[OrderDate] - DateTime.LocalNow()</code>, change type to Duration</li>
<li><strong>Merge columns:</strong> Select First Name and Last Name columns (hold Ctrl while clicking) ‚Üí <strong>Transform</strong> ‚Üí <strong>Merge Columns</strong></li>
<li><strong>Configure merge:</strong> Choose "Space" as separator, name the new column "Full Name", click OK</li>
<li><strong>Create conditional column:</strong> Click <strong>Add Column</strong> ‚Üí <strong>Conditional Column</strong></li>
<li><strong>Configure condition:</strong> Name: "Order Age Category", If "Year" equals current year, Output: "This Year", Else: "Previous Years"</li>
<li><strong>Reorder columns:</strong> Drag column headers to arrange them logically (Customer ID, Full Name, OrderDate, Year, Month, etc.)</li>
<li><strong>Close & Load:</strong> Click <strong>Home</strong> ‚Üí <strong>Close & Load</strong> to see your transformed data</li>
</ol>

<p><strong>üí° Tips:</strong></p>
<ul>
<li><strong>Add vs Transform:</strong> <strong>Add Column</strong> creates new columns (keeps original), <strong>Transform</strong> modifies existing columns (replaces original)</li>
<li><strong>Custom column power:</strong> Use M language in custom columns for complex calculations - similar to DAX formulas but for data transformation</li>
<li><strong>Date intelligence:</strong> Power Query has extensive date functions - explore <strong>Add Column</strong> ‚Üí <strong>Date</strong> for age, quarter, week number, etc.</li>
<li><strong>Conditional logic:</strong> Conditional Column is great for simple IF logic; use Custom Column for complex nested conditions</li>
<li><strong>Column selection:</strong> Hold <code>Ctrl</code> to select multiple non-adjacent columns, <code>Shift</code> to select a range</li>
<li><strong>Keyboard shortcut:</strong> Use <code>Alt + A + M</code> to open the "Merge Columns" dialog quickly</li>
</ul>

<p><strong>‚úÖ Expected Result:</strong> A transformed dataset with split name columns, extracted date components (Year, Month Name, Day Name), merged full names, calculated days since order, and conditional categorization - all created without formulas in the Excel grid!</p>

<p><strong>üîÑ Connection to Day 11:</strong> Day 11's date functions (TODAY, DATEDIFF, EOMONTH) work on individual cells. Power Query applies these transformations to entire columns at once during data import, creating a more efficient, automated workflow!</p>
</div>

<div class="section-card">
<p><strong>Exercise 3: Merge Queries to Combine Customer and Order Data</strong></p>
<p><strong>Goal:</strong> Master Power Query's Merge feature to combine data from multiple tables, similar to SQL JOINs.</p>

<p><strong>Setup:</strong> You need two Excel tables or CSV files - one with customer information (CustomerID, Name, Email) and another with orders (OrderID, CustomerID, OrderDate, Amount).</p>

<p><strong>Step-by-Step Instructions:</strong></p>
<ol>
<li><strong>Import first table:</strong> Go to <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí select your Customers file</li>
<li><strong>Load to Power Query:</strong> Click <strong>Transform Data</strong> to open in Power Query Editor</li>
<li><strong>Rename the query:</strong> In the Query Settings pane (right side), change the name from "Sheet1" to "Customers"</li>
<li><strong>Clean the data:</strong> Apply any necessary transformations (remove duplicates on CustomerID, trim spaces, etc.)</li>
<li><strong>Click "Close & Load To":</strong> Click the dropdown arrow next to "Close & Load" ‚Üí <strong>Close & Load To...</strong></li>
<li><strong>Select "Only Create Connection":</strong> This loads the query but doesn't add it to a worksheet yet - click OK</li>
<li><strong>Import second table:</strong> Go to <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí select your Orders file</li>
<li><strong>Load and rename:</strong> Click <strong>Transform Data</strong>, rename the query to "Orders"</li>
<li><strong>Start the merge:</strong> With Orders query open, click <strong>Home</strong> ‚Üí <strong>Merge Queries</strong> (not "Merge Queries as New")</li>
<li><strong>Configure the merge:</strong>
   - Top dropdown: Select "Orders" (should already be selected)
   - Click the CustomerID column in the Orders preview
   - Bottom dropdown: Select "Customers"
   - Click the CustomerID column in the Customers preview
   - Join Kind: Select "Left Outer (all from first, matching from second)"
   - Click OK
</li>
<li><strong>Expand the merged column:</strong> A new column appears named "Customers" with "Table" values. Click the expand icon (two arrows) in the column header</li>
<li><strong>Select columns to expand:</strong> Uncheck "Use original column name as prefix", select "Name" and "Email", click OK</li>
<li><strong>Review the results:</strong> You now have order data enriched with customer names and emails from the Customers table</li>
<li><strong>Rename expanded columns:</strong> Rename "Name" to "Customer Name" and "Email" to "Customer Email" for clarity</li>
<li><strong>Close & Load:</strong> Click <strong>Home</strong> ‚Üí <strong>Close & Load</strong> to see the merged data in Excel</li>
<li><strong>Test refresh:</strong> Try updating the source data and right-click the table ‚Üí <strong>Refresh</strong> to see changes propagate</li>
</ol>

<p><strong>üí° Tips:</strong></p>
<ul>
<li><strong>Join types explained:</strong> Left Outer (all orders + matching customers), Inner (only orders with customers), Full Outer (all from both), Right Outer (all customers + matching orders)</li>
<li><strong>Merge vs Append:</strong> Use Merge to add columns (like SQL JOIN), use Append to add rows (like UNION)</li>
<li><strong>Multiple column merge:</strong> Hold <code>Ctrl</code> and select multiple columns in each table to merge on composite keys</li>
<li><strong>Merge as New:</strong> Use "Merge Queries as New" to create a third query without modifying the original - great for creating multiple views</li>
<li><strong>Performance tip:</strong> Merge queries load faster than VLOOKUP formulas for large datasets - Power Query is optimized for data operations</li>
<li><strong>Fuzzy matching:</strong> Power Query can do fuzzy matching for approximate joins - useful when data isn't perfectly clean</li>
</ul>

<p><strong>‚úÖ Expected Result:</strong> A single table showing all orders with enriched customer information (Name, Email) pulled from the Customers table, similar to a SQL LEFT JOIN. Changes to source data are reflected when you refresh the query.</p>

<p><strong>üîÑ Connection to Day 6:</strong> Day 6 taught SQL JOINs to combine tables in databases. Power Query's Merge does the same thing in Excel, letting you work with relational data without SQL - perfect for combining data from multiple sources!</p>
</div>

<div class="section-card">
<p><strong>Exercise 4: Append Multiple Data Sources into One Table</strong></p>
<p><strong>Goal:</strong> Learn to combine multiple tables with the same structure into a single consolidated table using Append.</p>

<p><strong>Setup:</strong> Create or obtain three separate files with the same column structure - for example, sales data from Q1, Q2, and Q3 in separate CSV files or Excel sheets.</p>

<p><strong>Step-by-Step Instructions:</strong></p>
<ol>
<li><strong>Import first dataset:</strong> Go to <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí select Q1_Sales.csv</li>
<li><strong>Transform and rename:</strong> Click <strong>Transform Data</strong>, rename query to "Q1_Sales"</li>
<li><strong>Add a source column:</strong> Click <strong>Add Column</strong> ‚Üí <strong>Custom Column</strong>, name it "Quarter", value: <code>"Q1"</code>, click OK</li>
<li><strong>Load as connection only:</strong> Click <strong>Close & Load To</strong> ‚Üí <strong>Only Create Connection</strong></li>
<li><strong>Import second dataset:</strong> <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí select Q2_Sales.csv</li>
<li><strong>Transform and add identifier:</strong> Click <strong>Transform Data</strong>, rename to "Q2_Sales", add Custom Column "Quarter" with value <code>"Q2"</code></li>
<li><strong>Load as connection only:</strong> <strong>Close & Load To</strong> ‚Üí <strong>Only Create Connection</strong></li>
<li><strong>Import third dataset:</strong> Repeat for Q3_Sales.csv, adding Quarter column with value <code>"Q3"</code></li>
<li><strong>Create new Append query:</strong> Go to <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>Combine Queries</strong> ‚Üí <strong>Append</strong></li>
<li><strong>Choose "Three or more tables":</strong> Select this option (even though we have exactly 3), click OK</li>
<li><strong>Select tables to append:</strong> In "Available tables", select Q1_Sales, click <strong>Add</strong>, repeat for Q2_Sales and Q3_Sales</li>
<li><strong>Review table order:</strong> The order in "Tables to append" determines row order in final result - reorder if needed using arrows</li>
<li><strong>Click OK:</strong> Power Query creates a new query combining all three tables</li>
<li><strong>Rename the combined query:</strong> Change name from "Append1" to "All_Sales_2024"</li>
<li><strong>Add year column:</strong> Click <strong>Add Column</strong> ‚Üí <strong>Custom Column</strong>, name: "Year", value: <code>2024</code></li>
<li><strong>Sort by date:</strong> Select the Date column ‚Üí <strong>Home</strong> ‚Üí <strong>Sort Ascending</strong></li>
<li><strong>Group by quarter:</strong> Click <strong>Transform</strong> ‚Üí <strong>Group By</strong>, Group by: Quarter, New column name: "Total Sales", Operation: Sum, Column: Amount</li>
<li><strong>Undo grouping to see details:</strong> Click the X next to "Grouped Rows" in Applied Steps (we just wanted to see how grouping works)</li>
<li><strong>Close & Load:</strong> Click <strong>Home</strong> ‚Üí <strong>Close & Load</strong> to load the consolidated data</li>
</ol>

<p><strong>üí° Tips:</strong></p>
<ul>
<li><strong>Append vs Merge reminder:</strong> Append stacks tables vertically (combines rows), Merge joins tables horizontally (combines columns)</li>
<li><strong>Column matching:</strong> Append matches columns by name - ensure column headers are identical across all tables</li>
<li><strong>Handling mismatched columns:</strong> If tables have different columns, Append includes all columns and fills missing values with null</li>
<li><strong>Folder append:</strong> Use <strong>Get Data</strong> ‚Üí <strong>From Folder</strong> to automatically append all files in a directory - great for monthly reports!</li>
<li><strong>Append as New:</strong> Use "Append Queries as New" to create a separate combined query without modifying originals</li>
<li><strong>Performance advantage:</strong> Appending in Power Query is much faster than copying/pasting data from multiple files manually</li>
</ul>

<p><strong>‚úÖ Expected Result:</strong> A single consolidated table containing all sales records from Q1, Q2, and Q3, with each row tagged with its source quarter. The table automatically updates when source files change and you refresh the query.</p>

<p><strong>üîÑ Connection to Day 8:</strong> Day 8 used SQL GROUP BY to aggregate data. Power Query's Group By does the same thing, and when combined with Append, you can consolidate and analyze data from multiple sources in one operation!</p>
</div>

<div class="section-card">
<p><strong>Exercise 5: Create Reusable Data Transformation Workflows</strong></p>
<p><strong>Goal:</strong> Build a complete end-to-end Power Query workflow that imports, cleans, transforms, and combines data - creating a reusable, production-ready data pipeline.</p>

<p><strong>Setup:</strong> Use multiple data sources - a CSV file with sales data (messy), an Excel file with product information, and another Excel file with customer data.</p>

<p><strong>Step-by-Step Instructions:</strong></p>
<ol>
<li><strong>Import and clean sales data:</strong>
   - <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí <strong>From Text/CSV</strong> ‚Üí select sales file
   - Click <strong>Transform Data</strong>, rename query to "Sales_Raw"
   - Remove duplicates on OrderID column
   - Trim and capitalize all text columns
   - Change OrderDate to Date type, Amount to Currency type
   - Filter out rows where Amount is null or zero
   - <strong>Close & Load To</strong> ‚Üí <strong>Only Create Connection</strong>
</li>
<li><strong>Import product reference data:</strong>
   - <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí <strong>From Excel Workbook</strong> ‚Üí select products file
   - Click <strong>Transform Data</strong>, rename to "Products"
   - Remove any unnecessary columns
   - Ensure ProductID is Whole Number type
   - <strong>Close & Load To</strong> ‚Üí <strong>Only Create Connection</strong>
</li>
<li><strong>Import customer reference data:</strong>
   - <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí <strong>From Excel Workbook</strong> ‚Üí select customers file
   - Click <strong>Transform Data</strong>, rename to "Customers"
   - Remove duplicates on CustomerID
   - Clean email addresses (trim, lowercase)
   - <strong>Close & Load To</strong> ‚Üí <strong>Only Create Connection</strong>
</li>
<li><strong>Create integrated sales report query:</strong>
   - Right-click "Sales_Raw" in Queries pane ‚Üí <strong>Reference</strong> (this creates a new query based on Sales_Raw)
   - Rename the new query to "Sales_Report"
</li>
<li><strong>Merge with Products:</strong>
   - Click <strong>Home</strong> ‚Üí <strong>Merge Queries</strong>
   - Select ProductID in Sales_Report, select Products table, select ProductID, use Left Outer join
   - Expand to include Product Name and Category
</li>
<li><strong>Merge with Customers:</strong>
   - Click <strong>Home</strong> ‚Üí <strong>Merge Queries</strong> again
   - Select CustomerID in current query, select Customers table, select CustomerID, use Left Outer join
   - Expand to include Customer Name and Email
</li>
<li><strong>Add calculated columns:</strong>
   - <strong>Add Column</strong> ‚Üí <strong>Custom Column</strong>, name: "Year", formula: <code>Date.Year([OrderDate])</code>
   - <strong>Add Column</strong> ‚Üí <strong>Custom Column</strong>, name: "Month", formula: <code>Date.MonthName([OrderDate])</code>
   - <strong>Add Column</strong> ‚Üí <strong>Custom Column</strong>, name: "Quarter", formula: <code>"Q" & Text.From(Date.QuarterOfYear([OrderDate]))</code>
</li>
<li><strong>Add revenue category:</strong>
   - <strong>Add Column</strong> ‚Üí <strong>Conditional Column</strong>
   - Name: "Revenue Category"
   - If Amount is greater than or equal to 1000, Output: "High Value"
   - Else if Amount is greater than or equal to 500, Output: "Medium Value"
   - Else: "Low Value"
</li>
<li><strong>Reorder and clean up columns:</strong>
   - Arrange columns logically: OrderID, OrderDate, Year, Month, Quarter, CustomerID, Customer Name, Email, ProductID, Product Name, Category, Amount, Revenue Category
   - Remove any intermediate columns you don't need
</li>
<li><strong>Add documentation:</strong>
   - Right-click the query ‚Üí <strong>Properties</strong>
   - Add description: "Integrated sales report combining sales, product, and customer data with enrichments"
</li>
<li><strong>Close & Load:</strong> Click <strong>Home</strong> ‚Üí <strong>Close & Load</strong> to create the final report table</li>
<li><strong>Test the workflow:</strong>
   - Modify one of the source files (add a row, change a value)
   - Right-click the Sales_Report table ‚Üí <strong>Refresh</strong>
   - Verify that changes propagate through the entire workflow
</li>
<li><strong>View query dependencies:</strong> Click <strong>Data</strong> ‚Üí <strong>Queries & Connections</strong> ‚Üí <strong>Query Dependencies</strong> to see how queries relate</li>
</ol>

<p><strong>üí° Tips:</strong></p>
<ul>
<li><strong>Reference vs Duplicate:</strong> "Reference" creates a query that depends on another (efficient), "Duplicate" creates an independent copy (flexible)</li>
<li><strong>Query organization:</strong> Group related queries into folders in the Queries pane for better organization in complex workbooks</li>
<li><strong>Parameter queries:</strong> Create parameter queries to make your workflow dynamic (e.g., date ranges, file paths) - accessible via <strong>Manage Parameters</strong></li>
<li><strong>Error handling:</strong> Use <strong>Keep Errors</strong> or <strong>Remove Errors</strong> to handle data quality issues gracefully in production workflows</li>
<li><strong>Performance optimization:</strong> Disable "Enable load" for intermediate queries (only load final results to Excel) to improve workbook performance</li>
<li><strong>Sharing workflows:</strong> Power Query transformations are saved in the Excel file - when you share the workbook, others can refresh your queries automatically</li>
</ul>

<p><strong>‚úÖ Expected Result:</strong> A comprehensive, production-ready sales report that automatically imports data from three sources, cleans and validates it, enriches it with product and customer information, adds calculated fields and categorizations, and can be refreshed with one click to reflect updated source data. This workflow is fully documented and reusable.</p>

<p><strong>üîÑ Connection to Day 10:</strong> Day 10 introduced SQL subqueries for complex data retrieval. Power Query workflows achieve similar complexity by chaining transformations and combining queries, but with a visual, user-friendly interface. Both approaches build layered data logic - SQL uses nested queries, Power Query uses referenced queries!</p>
</div>
<h3 id="independent-practice-hour-3---60-min-15">Independent Practice (60 min):</h3>
<div class="practice-note">
<p><strong>üí° Hints for Independent Practice:</strong></p>
<ul>
<li><strong>Start simple:</strong> Begin with basic variations before attempting complex modifications</li>
<li><strong>Break it down:</strong> Divide complex problems into smaller, manageable steps</li>
<li><strong>Test incrementally:</strong> Verify each step works before moving to the next</li>
<li><strong>Use documentation:</strong> Refer to official docs or tutorials when needed</li>
<li><strong>Experiment:</strong> Try different approaches to find what works best</li>
</ul>
</div>
<p>Apply the concepts learned to different datasets and scenarios.</p>
<h3 id="daily-assignment-hour-4---60-min-15">Daily Assignment (60 min):</h3>
<p><strong>Assignment:</strong></p>
<ul>
<li><strong>Data Cleaning:</strong>Remove duplicates, handle nulls, fix data types, clean text</li>
<li><strong>Transformation:</strong>Create calculated columns, group by category, pivot data</li>
<li><strong>Merge Queries:</strong>Combine customer table with orders table</li>
</ul>
<h3 id="expected-outcomes-15">Expected Outcomes:</h3>
<ul>
<li>Introduction to Power Query Editor</li>
<li>Import and transform data from multiple sources</li>
<li>Clean and reshape data</li>
<li>Combine queries (merge and append)</li>
<li>Review Week 3 concepts</li>
</ul>
<h2 id="quick-quiz-day-15">üìù Day 15 Quick Quiz - Test Your Knowledge!</h2>
<div class="quiz-container" data-day="15">
<div class="quiz-question" data-correct="1" data-question="1">
<p class="question-text"><strong>Q1.</strong> What is Power Query primarily used for?</p>
<div class="quiz-options">
<label class="quiz-option">
<input name="day15_q1" type="radio" value="0"/>
<span class="option-text">Writing queries</span>
</label>
<label class="quiz-option">
<input name="day15_q1" type="radio" value="1"/>
<span class="option-text">ETL: Extracting, transforming, and loading data</span>
</label>
<label class="quiz-option">
<input name="day15_q1" type="radio" value="2"/>
<span class="option-text">Creating charts</span>
</label>
<label class="quiz-option">
<input name="day15_q1" type="radio" value="3"/>
<span class="option-text">Formatting cells</span>
</label>
</div>
<div class="quiz-feedback" style="display:none;">
<p class="feedback-text"></p>
<p class="explanation">Power Query is Excel's ETL tool for data extraction, transformation, and loading.</p>
</div>
</div>
<div class="quiz-question" data-correct="1" data-question="2">
<p class="question-text"><strong>Q2.</strong> What's the advantage of Power Query over manual data cleaning?</p>
<div class="quiz-options">
<label class="quiz-option">
<input name="day15_q2" type="radio" value="0"/>
<span class="option-text">It's prettier</span>
</label>
<label class="quiz-option">
<input name="day15_q2" type="radio" value="1"/>
<span class="option-text">Steps are recorded and can be refreshed when data changes</span>
</label>
<label class="quiz-option">
<input name="day15_q2" type="radio" value="2"/>
<span class="option-text">It's faster to type</span>
</label>
<label class="quiz-option">
<input name="day15_q2" type="radio" value="3"/>
<span class="option-text">It uses less memory</span>
</label>
</div>
<div class="quiz-feedback" style="display:none;">
<p class="feedback-text"></p>
<p class="explanation">Power Query records transformation steps, making them repeatable and refreshable.</p>
</div>
</div>
<div class="quiz-question" data-correct="1" data-question="3">
<p class="question-text"><strong>Q3.</strong> What is the Power Query Editor?</p>
<div class="quiz-options">
<label class="quiz-option">
<input name="day15_q3" type="radio" value="0"/>
<span class="option-text">Text editor</span>
</label>
<label class="quiz-option">
<input name="day15_q3" type="radio" value="1"/>
<span class="option-text">Interface for building and modifying data transformation steps</span>
</label>
<label class="quiz-option">
<input name="day15_q3" type="radio" value="2"/>
<span class="option-text">Code editor</span>
</label>
<label class="quiz-option">
<input name="day15_q3" type="radio" value="3"/>
<span class="option-text">Chart editor</span>
</label>
</div>
<div class="quiz-feedback" style="display:none;">
<p class="feedback-text"></p>
<p class="explanation">Power Query Editor is where you build, view, and modify transformation steps.</p>
</div>
</div>
<div class="quiz-question" data-correct="1" data-question="4">
<p class="question-text"><strong>Q4.</strong> Can Power Query connect to multiple data sources?</p>
<div class="quiz-options">
<label class="quiz-option">
<input name="day15_q4" type="radio" value="0"/>
<span class="option-text">No, only Excel files</span>
</label>
<label class="quiz-option">
<input name="day15_q4" type="radio" value="1"/>
<span class="option-text">Yes, databases, web, files, and many other sources</span>
</label>
<label class="quiz-option">
<input name="day15_q4" type="radio" value="2"/>
<span class="option-text">Only to SQL databases</span>
</label>
<label class="quiz-option">
<input name="day15_q4" type="radio" value="3"/>
<span class="option-text">Only to text files</span>
</label>
</div>
<div class="quiz-feedback" style="display:none;">
<p class="feedback-text"></p>
<p class="explanation">Power Query connects to 100+ sources: Excel, databases, web, cloud services, etc.</p>
</div>
</div>
<div class="quiz-question" data-correct="1" data-question="5">
<p class="question-text"><strong>Q5.</strong> What does 'Load To' in Power Query determine?</p>
<div class="quiz-options">
<label class="quiz-option">
<input name="day15_q5" type="radio" value="0"/>
<span class="option-text">Source location</span>
</label>
<label class="quiz-option">
<input name="day15_q5" type="radio" value="1"/>
<span class="option-text">Where transformed data is loaded (worksheet, data model, etc.)</span>
</label>
<label class="quiz-option">
<input name="day15_q5" type="radio" value="2"/>
<span class="option-text">Query speed</span>
</label>
<label class="quiz-option">
<input name="day15_q5" type="radio" value="3"/>
<span class="option-text">Data format</span>
</label>
</div>
<div class="quiz-feedback" style="display:none;">
<p class="feedback-text"></p>
<p class="explanation">'Load To' specifies destination: worksheet table, pivot table, or data model only.</p>
</div>
</div>
</div>
<hr/>
  </div>
</div>
<div class="feedback-bar">
  <p>Have feedback or questions? <a href="mailto:gcpath@live.com?subject=30-Day Excel & SQL Training Feedback" class="feedback-link">Email us at gcpath@live.com</a></p>
</div>
<button class="back-to-top" id="back-to-top" aria-label="Back to top"></button>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // 1. Add copy buttons to all code blocks
  document.querySelectorAll('pre').forEach(pre => {
    const button = document.createElement('button');
    button.className = 'copy-btn';
    button.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
    </svg>`;
    button.setAttribute('aria-label', 'Copy code');
    button.setAttribute('title', 'Copy to clipboard');

    button.addEventListener('click', async () => {
      const code = pre.querySelector('code') || pre;
      const text = code.textContent;

      try {
        await navigator.clipboard.writeText(text);
        button.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>`;
        button.classList.add('copied');
        setTimeout(() => {
          button.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
          </svg>`;
          button.classList.remove('copied');
        }, 2000);
      } catch (err) {
        button.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>`;
        setTimeout(() => {
          button.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
          </svg>`;
        }, 2000);
      }
    });

    pre.appendChild(button);
  });

  // 1b. Add AI assistant buttons dynamically to AI prompt code blocks
  const aiPromptHeadings = document.querySelectorAll('h3[id*="ai-learning-prompts"]');

  aiPromptHeadings.forEach(heading => {
    // Find ALL code blocks after this heading (until next h2 or h3)
    let currentElement = heading.nextElementSibling;
    const codeBlocks = [];

    while (currentElement) {
      // Stop if we hit another heading
      if (currentElement.tagName === 'H2' || currentElement.tagName === 'H3') {
        break;
      }

      // Collect all PRE elements
      if (currentElement.tagName === 'PRE') {
        codeBlocks.push(currentElement);
      }

      currentElement = currentElement.nextElementSibling;
    }

    // Add buttons to each code block found
    codeBlocks.forEach(codeBlock => {
      // Get the prompt text from THIS specific code block
      const code = codeBlock.querySelector('code') || codeBlock;
      const promptText = code.textContent.trim();

      // Create AI buttons container for THIS prompt
      const aiButtonsContainer = document.createElement('div');
      aiButtonsContainer.className = 'ai-assistant-buttons';

      // ChatGPT button - Black and white icon
      const chatgptBtn = document.createElement('a');
      chatgptBtn.href = 'https://chat.openai.com/?q=' + encodeURIComponent(promptText);
      chatgptBtn.target = '_blank';
      chatgptBtn.className = 'ai-quick-btn chatgpt-btn';
      chatgptBtn.title = 'Open in ChatGPT';
      chatgptBtn.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M22.282 9.821a5.985 5.985 0 0 0-.516-4.91 6.046 6.046 0 0 0-6.51-2.9A6.065 6.065 0 0 0 4.981 4.18a5.985 5.985 0 0 0-3.998 2.9 6.046 6.046 0 0 0 .743 7.097 5.98 5.98 0 0 0 .51 4.911 6.051 6.051 0 0 0 6.515 2.9A5.985 5.985 0 0 0 13.26 24a6.056 6.056 0 0 0 5.772-4.206 5.99 5.99 0 0 0 3.997-2.9 6.056 6.056 0 0 0-.747-7.073zM13.26 22.43a4.476 4.476 0 0 1-2.876-1.04l.141-.081 4.779-2.758a.795.795 0 0 0 .392-.681v-6.737l2.02 1.168a.071.071 0 0 1 .038.052v5.583a4.504 4.504 0 0 1-4.494 4.494zM3.6 18.304a4.47 4.47 0 0 1-.535-3.014l.142.085 4.783 2.759a.771.771 0 0 0 .78 0l5.843-3.369v2.332a.08.08 0 0 1-.033.062L9.74 19.95a4.5 4.5 0 0 1-6.14-1.646zM2.34 7.896a4.485 4.485 0 0 1 2.366-1.973V11.6a.766.766 0 0 0 .388.676l5.815 3.355-2.02 1.168a.076.076 0 0 1-.071 0l-4.83-2.786A4.504 4.504 0 0 1 2.34 7.872zm16.597 3.855l-5.833-3.387L15.119 7.2a.076.076 0 0 1 .071 0l4.83 2.791a4.494 4.494 0 0 1-.676 8.105v-5.678a.79.79 0 0 0-.407-.667zm2.01-3.023l-.141-.085-4.774-2.782a.776.776 0 0 0-.785 0L9.409 9.23V6.897a.066.066 0 0 1 .028-.061l4.83-2.787a4.5 4.5 0 0 1 6.68 4.66zm-12.64 4.135l-2.02-1.164a.08.08 0 0 1-.038-.057V6.075a4.5 4.5 0 0 1 7.375-3.453l-.142.08L8.704 5.46a.795.795 0 0 0-.393.681zm1.097-2.365l2.602-1.5 2.607 1.5v2.999l-2.597 1.5-2.607-1.5z"/></svg>';

      // Claude button - Official Anthropic icon
      const claudeBtn = document.createElement('a');
      claudeBtn.href = 'https://claude.ai/new?q=' + encodeURIComponent(promptText);
      claudeBtn.target = '_blank';
      claudeBtn.className = 'ai-quick-btn claude-btn';
      claudeBtn.title = 'Open in Claude';
      claudeBtn.innerHTML = '<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Claude_AI_symbol.svg/1024px-Claude_AI_symbol.svg.png" width="14" height="14" style="display: block;" alt="Claude">';

      // Google button
      const googleBtn = document.createElement('a');
      googleBtn.href = 'https://www.google.com/search?q=' + encodeURIComponent(promptText);
      googleBtn.target = '_blank';
      googleBtn.className = 'ai-quick-btn google-btn';
      googleBtn.title = 'Search in Google';
      googleBtn.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>';

      // Add buttons to container
      aiButtonsContainer.appendChild(chatgptBtn);
      aiButtonsContainer.appendChild(claudeBtn);
      aiButtonsContainer.appendChild(googleBtn);

      // Append to the code block
      codeBlock.appendChild(aiButtonsContainer);
    });
  });

  // 1c. Quiz interaction functionality
  document.querySelectorAll('.quiz-question').forEach(question => {
    const options = question.querySelectorAll('input[type="radio"]');
    const feedback = question.querySelector('.quiz-feedback');
    const feedbackText = feedback.querySelector('.feedback-text');
    const correctAnswer = parseInt(question.dataset.correct);

    options.forEach((option, index) => {
      option.addEventListener('change', () => {
        const selectedAnswer = parseInt(option.value);

        // Show feedback
        feedback.style.display = 'block';

        if (selectedAnswer === correctAnswer) {
          // Correct answer
          question.classList.remove('incorrect');
          question.classList.add('correct');
          feedback.classList.remove('incorrect');
          feedback.classList.add('correct');
          feedbackText.classList.remove('incorrect');
          feedbackText.classList.add('correct');
          feedbackText.textContent = '‚úÖ Correct!';
        } else {
          // Incorrect answer
          question.classList.remove('correct');
          question.classList.add('incorrect');
          feedback.classList.remove('correct');
          feedback.classList.add('incorrect');
          feedbackText.classList.remove('correct');
          feedbackText.classList.add('incorrect');
          feedbackText.textContent = '‚ùå Incorrect. Try again!';
        }

        // Disable other options after selection
        options.forEach(opt => {
          if (opt !== option) {
            opt.disabled = selectedAnswer === correctAnswer;
          }
        });
      });
    });
  });

  // 2. Theme toggle functionality (Claude-style)
  const themeToggle = document.getElementById('theme-toggle');
  const themeIcon = document.querySelector('.theme-icon');
  const themeText = document.querySelector('.theme-text');

  // Load saved theme
  const savedTheme = localStorage.getItem('training-theme') || 'light';
  document.documentElement.setAttribute('data-theme', savedTheme);
  updateThemeButton(savedTheme);

  function updateThemeButton(theme) {
    if (theme === 'dark') {
      themeIcon.textContent = '‚òÄÔ∏è';
      themeText.textContent = 'Light';
    } else {
      themeIcon.textContent = 'üåô';
      themeText.textContent = 'Dark';
    }
  }

  if (themeToggle) {
    themeToggle.addEventListener('click', () => {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('training-theme', newTheme);
      updateThemeButton(newTheme);
    });
  }

  // 2b. Font selector functionality
  const fontSelector = document.getElementById('font-selector');

  // Load saved font preference (default to Candara)
  const savedFont = localStorage.getItem('training-font') || 'candara';
  document.documentElement.setAttribute('data-font', savedFont);
  fontSelector.value = savedFont;

  fontSelector.addEventListener('change', (e) => {
    const selectedFont = e.target.value;
    document.documentElement.setAttribute('data-font', selectedFont);
    localStorage.setItem('training-font', selectedFont);
  });

  // 2c. Font size controls
  const fontSizes = ['small', 'medium', 'large', 'x-large'];
  const decreaseBtn = document.getElementById('decrease-font');
  const increaseBtn = document.getElementById('increase-font');

  // Load saved font size (default to medium)
  let currentSizeIndex = fontSizes.indexOf(localStorage.getItem('training-font-size') || 'medium');
  if (currentSizeIndex === -1) currentSizeIndex = 1; // Default to medium

  function applyFontSize(index) {
    document.documentElement.setAttribute('data-font-size', fontSizes[index]);
    localStorage.setItem('training-font-size', fontSizes[index]);

    // Disable buttons at limits
    decreaseBtn.disabled = index === 0;
    increaseBtn.disabled = index === fontSizes.length - 1;
  }

  applyFontSize(currentSizeIndex);

  decreaseBtn.addEventListener('click', () => {
    if (currentSizeIndex > 0) {
      currentSizeIndex--;
      applyFontSize(currentSizeIndex);
    }
  });

  increaseBtn.addEventListener('click', () => {
    if (currentSizeIndex < fontSizes.length - 1) {
      currentSizeIndex++;
      applyFontSize(currentSizeIndex);
    }
  });

  // 3. Highlight active page in TOC and scroll to it (improved)
  const currentPage = window.location.pathname.split('/').pop() || 'SQL-and-Excel-Course.html';
  const tocLinks = document.querySelectorAll('nav#TOC a');
  const tocLinksArray = Array.from(tocLinks);

  tocLinks.forEach((link, index) => {
    const linkHref = link.getAttribute('href');
    if (linkHref === currentPage || linkHref === `../${currentPage}`) {
      link.classList.add('active');

      // Smart TOC scrolling - center items unless near the end
      setTimeout(() => {
        const totalLinks = tocLinksArray.length;
        const isNearEnd = index > totalLinks * 0.8; // Last 20% of links

        // Use scrollIntoView for smooth, smart scrolling
        link.scrollIntoView({
          behavior: 'smooth',
          block: isNearEnd ? 'nearest' : 'center',
          inline: 'nearest'
        });
      }, 100);
    }
  });

  // 4. Back to top button functionality
  const backToTopBtn = document.getElementById('back-to-top');
  if (backToTopBtn) {
    backToTopBtn.addEventListener('click', () => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
  }
});
</script>

</body>
</html>